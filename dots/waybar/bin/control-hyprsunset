#!/bin/bash

STATE_FILE="$HOME/.cache/waybar/sunset-state"

default_brightness() {
    if pgrep -x "hyprsunset" >/dev/null; then
        hyprctl hyprsunset temperature 3500 &
    else
        hyprsunset &
        hyprctl hyprsunset temperature 3500 &
    fi
}

disable_brightness() {
    if pgrep -x "hyprsunset" >/dev/null; then
        hyprctl hyprsunset identity &
    else
        hyprsunset &
        hyprctl hyprsunset identity &
    fi
}

increase_brightness() {
    if pgrep -x "hyprsunset" >/dev/null; then
        hyprctl hyprsunset gamma +10 &
    else
        hyprsunset &
        hyprctl hyprsunset gamma +10 &
    fi
}

decrease_brightness() {
    if pgrep -x "hyprsunset" >/dev/null; then
        hyprctl hyprsunset gamma -10 &
    else
        hyprsunset &
        hyprctl hyprsunset gamma -10 &
    fi

}

if [ -f "$STATE_FILE" ] && [ $(cat "$STATE_FILE") = "on" ]; then
    default_brightness
else
    disable_brightness
fi

case "$1" in
increase) increase_brightness ;;
decrease) decrease_brightness ;;
esac
